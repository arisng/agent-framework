# AGUIWebChat Module Breakdown

## Overview
AGUIWebChat is a two-project sample consisting of an ASP.NET Core server that exposes an AG-UI endpoint and a Blazor Server client that renders the chat UI. The module breakdown below groups the sample into atomic responsibilities and lists inputs, outputs, and dependencies aligned with ASP.NET Core hosting, Blazor components, and HTTP client patterns. See the cited references for the underlying platform concepts (ASP.NET Core hosting and middleware, Blazor components and routing, JavaScript interop, and `IHttpClientFactory`).

## Module Groups

### Server Host & Agent Modules
These modules are responsible for hosting, configuration, agent creation, and exposing the AG-UI endpoint using ASP.NET Core minimal hosting patterns and endpoint mapping. See the ASP.NET Core hosting and minimal API documentation for the hosting model and endpoint registration patterns.

| Module                    | Responsibility                                                          | Inputs                                                  | Outputs                             | Dependencies                 | Primary files                                                                                                                                                                                                                                          |
| ------------------------- | ----------------------------------------------------------------------- | ------------------------------------------------------- | ----------------------------------- | ---------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Server host bootstrap     | Configure hosting, register services, and start the ASP.NET Core app.   | Environment, configuration                              | Running server, middleware pipeline | ASP.NET Core hosting model   | [dotnet/samples/AGUIWebChat/Server/Program.cs](dotnet/samples/AGUIWebChat/Server/Program.cs)                                                                                                                                                           |
| Azure OpenAI client setup | Create `AzureOpenAIClient` and `ChatClient` used by the agent.          | `AZURE_OPENAI_ENDPOINT`, `AZURE_OPENAI_DEPLOYMENT_NAME` | `ChatClient` instance               | Azure OpenAI .NET SDK        | [dotnet/samples/AGUIWebChat/Server/Program.cs](dotnet/samples/AGUIWebChat/Server/Program.cs)                                                                                                                                                           |
| Agent creation            | Build a `ChatClientAgent` with name, instructions, and tools.           | `ChatClient`                                            | `ChatClientAgent`                   | Agents SDK                   | [dotnet/samples/AGUIWebChat/Server/Program.cs](dotnet/samples/AGUIWebChat/Server/Program.cs)                                                                                                                                                           |
| Agentic UI wrapper        | Wrap the base agent to emit state events from plan tool results.        | `ChatClientAgent`, serializer options                   | `AIAgent` with state events         | Delegating agent pattern     | [dotnet/samples/AGUIWebChat/Server/AgenticUI/AgenticUIAgent.cs](dotnet/samples/AGUIWebChat/Server/AgenticUI/AgenticUIAgent.cs), [dotnet/samples/AGUIWebChat/Server/Program.cs](dotnet/samples/AGUIWebChat/Server/Program.cs)                           |
| Agentic UI tools & models | Provide plan tools and data models for snapshots and JSON Patch deltas. | Tool calls                                              | Plan snapshots and deltas           | Tool binding + JSON          | [dotnet/samples/AGUIWebChat/Server/AgenticUI/AgenticPlanningTools.cs](dotnet/samples/AGUIWebChat/Server/AgenticUI/AgenticPlanningTools.cs), [dotnet/samples/AGUIWebChat/Server/AgenticUI/Plan.cs](dotnet/samples/AGUIWebChat/Server/AgenticUI/Plan.cs) |
| AG-UI endpoint mapping    | Expose `/ag-ui` for agent interactions.                                 | `AIAgent` (wrapped)                                     | HTTP endpoint                       | Minimal API endpoint mapping | [dotnet/samples/AGUIWebChat/Server/Program.cs](dotnet/samples/AGUIWebChat/Server/Program.cs)                                                                                                                                                           |
| Server launch profile     | Configure local dev URL for the server.                                 | launch settings                                         | host URL                            | ASP.NET Core launch settings | [dotnet/samples/AGUIWebChat/Server/Properties/launchSettings.json](dotnet/samples/AGUIWebChat/Server/Properties/launchSettings.json)                                                                                                                   |

### Client Host & Service Registration Modules
These modules configure the Blazor Server host and register the chat client using `IHttpClientFactory`. See the Blazor hosting and HTTP client factory documentation for the hosting model and typed/ named client patterns.

| Module                    | Responsibility                                                          | Inputs          | Outputs                   | Dependencies                 | Primary files                                                                                                                        |
| ------------------------- | ----------------------------------------------------------------------- | --------------- | ------------------------- | ---------------------------- | ------------------------------------------------------------------------------------------------------------------------------------ |
| Client host bootstrap     | Configure Razor components, middleware, static assets, and render mode. | Environment     | Running Blazor Server app | Blazor Server hosting        | [dotnet/samples/AGUIWebChat/Client/Program.cs](dotnet/samples/AGUIWebChat/Client/Program.cs)                                         |
| AG-UI client registration | Configure `HttpClient` and `AGUIChatClient` for the server endpoint.    | `SERVER_URL`    | `IChatClient` service     | `IHttpClientFactory`         | [dotnet/samples/AGUIWebChat/Client/Program.cs](dotnet/samples/AGUIWebChat/Client/Program.cs)                                         |
| Client launch profile     | Configure local host URL and `SERVER_URL`.                              | launch settings | host URL, env vars        | ASP.NET Core launch settings | [dotnet/samples/AGUIWebChat/Client/Properties/launchSettings.json](dotnet/samples/AGUIWebChat/Client/Properties/launchSettings.json) |

### App Shell & Routing Modules
These modules define the app shell, routing, and layout that frame all pages. See the Blazor components and routing documentation for the component model and router behavior.

| Module    | Responsibility                                               | Inputs        | Outputs              | Dependencies           | Primary files                                                                                                                                                                                                            |
| --------- | ------------------------------------------------------------ | ------------- | -------------------- | ---------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| App shell | Provide the HTML shell, global styles, and script bootstrap. | Static assets | Page shell           | Blazor component model | [dotnet/samples/AGUIWebChat/Client/Components/App.razor](dotnet/samples/AGUIWebChat/Client/Components/App.razor), [dotnet/samples/AGUIWebChat/Client/wwwroot/app.css](dotnet/samples/AGUIWebChat/Client/wwwroot/app.css) |
| Routing   | Configure the router and root layout.                        | Route data    | Component navigation | Blazor routing         | [dotnet/samples/AGUIWebChat/Client/Components/Routes.razor](dotnet/samples/AGUIWebChat/Client/Components/Routes.razor)                                                                                                   |
| Layout    | Provide layout chrome and error UI.                          | Page content  | Layout markup        | Blazor layout model    | [dotnet/samples/AGUIWebChat/Client/Components/Layout/MainLayout.razor](dotnet/samples/AGUIWebChat/Client/Components/Layout/MainLayout.razor)                                                                             |

### Chat Page & UI Modules
These modules coordinate chat interactions, render messages, and handle input behaviors. They are standard Blazor components and use JS interop for specialized UI behaviors like auto-scroll or autosize input.

| Module                 | Responsibility                                                | Inputs                       | Outputs                      | Dependencies      | Primary files                                                                                                                                                                                                                                                                                                                        |
| ---------------------- | ------------------------------------------------------------- | ---------------------------- | ---------------------------- | ----------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Chat page orchestrator | Coordinate chat flow, agent calls, and child components.      | User messages, `IChatClient` | Streamed responses, UI state | Blazor components | [dotnet/samples/AGUIWebChat/Client/Components/Pages/Chat/Chat.razor](dotnet/samples/AGUIWebChat/Client/Components/Pages/Chat/Chat.razor)                                                                                                                                                                                             |
| Chat header            | Display title and “New chat” action.                          | UI callbacks                 | Header UI                    | Blazor components | [dotnet/samples/AGUIWebChat/Client/Components/Pages/Chat/ChatHeader.razor](dotnet/samples/AGUIWebChat/Client/Components/Pages/Chat/ChatHeader.razor)                                                                                                                                                                                 |
| Message list           | Render scrollable messages and auto-scroll behavior.          | Message collection           | Message list UI              | JS interop        | [dotnet/samples/AGUIWebChat/Client/Components/Pages/Chat/ChatMessageList.razor](dotnet/samples/AGUIWebChat/Client/Components/Pages/Chat/ChatMessageList.razor), [dotnet/samples/AGUIWebChat/Client/Components/Pages/Chat/ChatMessageList.razor.js](dotnet/samples/AGUIWebChat/Client/Components/Pages/Chat/ChatMessageList.razor.js) |
| Message item           | Render user/assistant messages, citations, and state updates. | Message model, `DataContent` | Message UI                   | Blazor components | [dotnet/samples/AGUIWebChat/Client/Components/Pages/Chat/ChatMessageItem.razor](dotnet/samples/AGUIWebChat/Client/Components/Pages/Chat/ChatMessageItem.razor), [dotnet/samples/AGUIWebChat/Client/Components/Pages/Chat/ChatCitation.razor](dotnet/samples/AGUIWebChat/Client/Components/Pages/Chat/ChatCitation.razor)             |
| Chat input             | Provide input box, keyboard shortcuts, and resizing.          | User text                    | Submit events                | JS interop        | [dotnet/samples/AGUIWebChat/Client/Components/Pages/Chat/ChatInput.razor](dotnet/samples/AGUIWebChat/Client/Components/Pages/Chat/ChatInput.razor), [dotnet/samples/AGUIWebChat/Client/Components/Pages/Chat/ChatInput.razor.js](dotnet/samples/AGUIWebChat/Client/Components/Pages/Chat/ChatInput.razor.js)                         |
| Suggestions            | Render follow-up suggestion buttons.                          | Suggestion list              | Click events                 | Blazor components | [dotnet/samples/AGUIWebChat/Client/Components/Pages/Chat/ChatSuggestions.razor](dotnet/samples/AGUIWebChat/Client/Components/Pages/Chat/ChatSuggestions.razor)                                                                                                                                                                       |
| Loading indicator      | Show streaming/progress feedback.                             | Loading state                | Spinner UI                   | Blazor components | [dotnet/samples/AGUIWebChat/Client/Components/Layout/LoadingSpinner.razor](dotnet/samples/AGUIWebChat/Client/Components/Layout/LoadingSpinner.razor)                                                                                                                                                                                 |

### Styling & Static Assets
These modules provide styles and static assets delivered by the ASP.NET Core static file middleware.

| Module           | Responsibility                         | Inputs            | Outputs           | Dependencies           | Primary files                                                                                                                                    |
| ---------------- | -------------------------------------- | ----------------- | ----------------- | ---------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------ |
| Global styles    | Base theme, layout, and shared styles. | CSS               | Theme styling     | Static files           | [dotnet/samples/AGUIWebChat/Client/wwwroot/app.css](dotnet/samples/AGUIWebChat/Client/wwwroot/app.css)                                           |
| Component styles | Component-level styling.               | CSS per component | Scoped UI styling | Blazor scoped CSS      | [dotnet/samples/AGUIWebChat/Client/Components/Pages/Chat/Chat.razor.css](dotnet/samples/AGUIWebChat/Client/Components/Pages/Chat/Chat.razor.css) |
| Static assets    | Icons and static files.                | Assets            | Static responses  | Static file middleware | [dotnet/samples/AGUIWebChat/Client/wwwroot/favicon.png](dotnet/samples/AGUIWebChat/Client/wwwroot/favicon.png)                                   |

## References
- ASP.NET Core hosting and startup: https://learn.microsoft.com/aspnet/core/fundamentals/host/generic-host?view=aspnetcore-8.0
- Minimal API endpoint mapping: https://learn.microsoft.com/aspnet/core/fundamentals/minimal-apis?view=aspnetcore-8.0
- Blazor overview: https://learn.microsoft.com/aspnet/core/blazor/?view=aspnetcore-8.0
- Blazor components and routing: https://learn.microsoft.com/aspnet/core/blazor/components/?view=aspnetcore-8.0
- Blazor JavaScript interop: https://learn.microsoft.com/aspnet/core/blazor/javascript-interoperability?view=aspnetcore-8.0
- IHttpClientFactory and HTTP requests: https://learn.microsoft.com/aspnet/core/fundamentals/http-requests?view=aspnetcore-8.0
- Azure OpenAI .NET SDK overview: https://learn.microsoft.com/azure/ai-services/openai/quickstart?tabs=command-line&pivots=programming-language-csharp
